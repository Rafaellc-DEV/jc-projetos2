{% extends "base.html" %}
{% load static %}

{% block title %}{{ categoria.nome }} - JC Online{% endblock %}

{% block extra_head %}
<style>
  /* === NOVO CSS PARA OS CRÉDITOS DA IMAGEM === */
  .image-credit-container {
    position: relative;
  }
  .image-credit {
    position: absolute;
    bottom: 8px;
    right: 12px;
    background-color: rgba(0, 0, 0, 0.6);
    color: white;
    padding: 2px 6px;
    font-size: 0.65rem;
    font-weight: 600;
    border-radius: 3px;
    z-index: 10;
  }
  /* === FIM DO NOVO CSS === */

  .category-page-title {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 2.5rem;
    color: var(--accent);
    border-bottom: 3px solid var(--accent);
    padding-bottom: 0.5rem;
    margin-bottom: 2rem;
    display: inline-block;
  }

  .news-list-item {
    display: flex;
    gap: 1.5rem;
    margin-bottom: 1.5rem;
    padding-bottom: 1.5rem;
    border-bottom: 1px solid var(--muted);
  }
  .news-list-item:last-child {
    border-bottom: none;
  }
  
  .news-list-image {
    flex-shrink: 0;
    width: 200px;
    height: 125px;
  }
  .news-list-image img, .news-list-placeholder {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 8px;
    background-color: var(--muted);
  }
  
  .news-list-content h3 {
    font-family: 'Playfair Display', serif;
    font-weight: 600;
    font-size: 1.3rem;
    color: var(--text);
    margin-bottom: 0.5rem;
  }
  .news-list-content a { text-decoration: none; }
  .news-list-content a:hover h3 { color: #0d6efd; }
  .news-list-content p {
    font-size: 0.95rem;
    color: var(--text);
    opacity: 0.8;
    margin-bottom: 0.25rem;
  }
  .news-list-content .news-date {
    font-size: 0.8rem;
    color: var(--text);
    opacity: 0.6;
  }

  .sidebar-wrapper {
    position: sticky;
    top: 85px;
  }
  .sidebar-module { /* sem caixa */ }
  .sidebar-module-title {
    font-family: 'Playfair Display', serif;
    font-weight: 700;
    font-size: 1.3rem;
    color: var(--text);
    border-bottom: 2px solid var(--accent);
    padding-bottom: 0.5rem;
    margin-bottom: 1rem;
  }
  .sidebar-list { list-style: none; padding-left: 0; }
  .sidebar-list li {
    margin-bottom: 0.75rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid var(--muted);
  }
  .sidebar-list li:last-child { margin-bottom: 0; padding-bottom: 0; border-bottom: none; }
  .sidebar-list a {
    color: var(--text);
    text-decoration: none;
    font-weight: 600;
    font-size: 0.95rem;
  }
  .sidebar-list a:hover { color: #0d6efd; }

  @media (max-width: 991px) {
    .news-list-item {
      flex-direction: column;
    }
    .news-list-image {
      width: 100%;
      height: 180px;
    }
    .sidebar-wrapper {
        position: static;
        margin-top: 2rem;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="row g-lg-4 g-xl-5">
  <div class="col-lg-9"> 

    <h1 class="category-page-title">{{ categoria.nome }}</h1>
    
    <section class="news-list">
      {% for noticia in noticias %}
        <article class="news-list-item">
          
          <a href="{% url 'noticia_detalhe' noticia.categoria.slug noticia.slug %}" class="news-list-image image-credit-container">
            {% if noticia.imagem %}
              <img src="{{ noticia.imagem.url }}" alt="{{ noticia.titulo }}">
              {% if noticia.imagem_credito %}
                <span class="image-credit">{{ noticia.imagem_credito }}</span>
              {% endif %}
            {% else %}
              <div class="news-list-placeholder d-flex align-items-center justify-content-center">
                <span class="text-muted small">Sem imagem</span>
              </div>
            {% endif %}
          </a>
          
          <div class="news-list-content">
            <a href="{% url 'noticia_detalhe' noticia.categoria.slug noticia.slug %}">
              <h3>{{ noticia.titulo }}</h3>
            </a>
            <p>{{ noticia.subtitulo|default:'' }}</p>
            <span class="news-date">{{ noticia.data_publicacao|date:"d/m/Y \à\s H:i" }}</span>
          </div>
        </article>
      {% empty %}
        <p class="text-muted">Ainda não há notícias publicadas nesta categoria.</p>
      {% endfor %}
    </section>
  </div>

  <div class="col-lg-3">
    <div class="sidebar-wrapper">
      {% if mais_recentes_sidebar %}
      <aside class="sidebar-module">
        <h3 class="sidebar-module-title">Veja Também</h3>
        <ul class="sidebar-list">
          {% for noticia in mais_recentes_sidebar %}
            <li>
              <a href="{% url 'noticia_detalhe' noticia.categoria.slug noticia.slug %}">
                {{ noticia.titulo }}
              </a>
            </li>
          {% endfor %}
        </ul>
      </aside>
      {% endif %}
    </div>
  </div>

</div>
{% endblock %}